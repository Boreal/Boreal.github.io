---
layout:     post
title:     计算机网络基础
subtitle:  五层模型, 网络协议
date:       2019-07-20
author:     Boreal
header-img: img/post-bg-2015.jpg
catalog: true
tags:
    - 计算机网络
---
#### 物理层(Physical Layer)


  计算机连接起来的物理手段，主要规定了网络的一些电气特性，作用是负责传送0和1的电信号；


#### 链接层(Link Layer)

   * 确定了传输的0和1的分组方式；
   * 以太网协议：传输帧，帧分为标头（Head）和数据（Data）；
   * MAC地址，即网卡地址，全球唯一，48个二进制位，通常使用12个十六进制数表示，前六个为厂商编号，后六个为厂商的网卡流水号；
   * 广播，以太网中通信必须知道接受方的MAC地址，通过ARP协议知道同一网段中其它所有计算机的MAC地址，向所有计算机发送消息，计算机判断自己是否为接收方；
   
#### 网络层(Network Layer)


   * 广播方式发送数据包效率低，且接收方必须在同一网段，区分同一个子网络的MAC地址，同一网络使用广播方式发送，否则采用“路由”方式发送；
   * “路由”意思就是指如何向不同的子网络分发数据包，MAC地址本身无法做到这点，于是导致了网络层的诞生；
   * 网络层的作用是引进一套新的地址，使得我们能够区分不同的计算机是否属于同一子网络，这套地址就叫“网络地址”，简称“网址”；
   * 网络地址确定计算机所在的子网络，MAC地址则将数据包送到该子网络中的目标网卡，因此，从逻辑上推断，必定是先处理网络地址，然后再处理MAC地址；
   * 规定网络地址的协议，叫做IP协议，它所定义的地址，叫做IP地址，IPv4由32个二进制位组成，IPv6由128个二进制位组成；
   * 判断是否在同一子网络：将两个IP地址与其子网掩码进行“逻辑与”运算，比较结果是否相同；
   * IP协议的主要作用：1. 为每一台计算机分配IP地址，2. 确定哪些地址在同一个子网络；
   * 根据IP协议发送的数据叫做IP数据包；
   * 由于IP数据包是放在以太网数据包里发送的，所以必须知道MAC地址与IP地址，通常情况下对方的IP地址是已知的，因此需要获得对方的MAC地址，两种情况：1. 两台主机不在同一子网络，只能将数据包发送到两个子网络连接处的网关处理。2. 两台主机在同一子网络中，可以使用ARP协议获取MAC地址；
   * ARP协议会发出一个数据包（包含在以太网数据包中），其中包含它所要查询主机的IP地址，在对方的MAC地址这一栏，填的是FF:FF:FF:FF:FF:FF，表示这是一个“广播”地址。它所在子网络的每一台主机，都会收到这个数据包，从中取出IP地址，与自身进行比较。如果两者相同，就做出回复，向对方报告自己的MAC地址，否则就丢弃这个包。
   
---

#### 传输层(Transport Layer)


  * 传输层的功能就是建立“端口到端口”的通信，“端口”是0到65535之间的整数，正好16个二进制位，0到1023的端口被系统占用。相比之下，网络层的功能是建立“主机到主机”的通信。只要确定主机和端口，就能实现程序之间的交流了。Unix系统就把主机+端口，叫做“套接字”（socket），有了它，就可以进行网络应用程序开发了；
  * UDP协议：UDP数据包由“标头”和“数据”两部分组成，“标头”部分主要定义了发出端口和接受端口，“数据”部分就是具体的内容。UDP数据包放在IP数据包的“数据”部分，而IP数据包又是放在以太网数据包中的“数据”部分。UDP数据包“标头”部分一共只有8个字节，总长度不超过65535字节，正好放进一个IP数据包；
  * TCP协议：UDP协议的优点是比较简单，容易实现，但是缺点是可靠性较差，一旦数据包发出，无法知道对方是否收到。可以近似的认为TCP就是有确认机制的UDP协议，每发出一个数据包都要求确认，如果有一个数据包遗失，就收不到确认，发出方就知道有必要重发这个数据包了。TCP协议虽然能够确保数据不会遗失，但是过程复杂、实现困难、消耗较多的资源。TCP数据包和UDP数据包一样，都是内嵌在IP数据包的“数据”部分，TCP数据包没有长度限制，理论上可以无限长，但是为了保证网络的效率，通常TCP数据包的长度不会超过IP数据包的长度，以确保单个TCP数据包不必分割。
  
#### 应用层(Application Layer)

  
  * 应用层的作用就是规定应用程序的数据格式；
  * 应用程序收到传输层的数据，接下来就要进行解读。由于互联网是开发架构，数据来源五花八门，必须事先规定好格式，否则根本无法解读。例如TCP协议可以为各种各样的程序传递数据，Email、WWW、FTP、等等，那么必须有不同协议规定电子邮件、网页、FTP数据的格式，这些应用程序协议就构成了应用层；
  * 这是最高的一层，直接面对用户，它的数据部分就放在TCP数据包的“数据”部分，因此以太网数据的构成如下：
  ![以太网数据构成](https://raw.githubusercontent.com/Boreal/Boreal.github.io/master/img/%E4%BB%A5%E5%A4%AA%E7%BD%91%E6%95%B0%E6%8D%AE%E6%9E%84%E6%88%90.png)
  
